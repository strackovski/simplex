{% extends "admin/default/masters/layout-admin.html.twig" %}

{% form_theme form with ['bootstrap.html.twig', 'admin/default/masters/flat-form.html.twig'] %}

{% block content %}
<div class="main-content affix-content">
    <script type="text/javascript" src="{{ app.request.basepath }}/assets/tinymce/tinymce.min.js"></script>

    <div class="affixed posts">
        <div class="row">
            <div class="col-xs-4 affix-left-controls">
                <div class="btn-group">
                    <a href="{{ app.url_generator.generate('admin/posts') }}" class="btn btn-round btn-action tooltipped" data-toggle="tooltip" data-placement="right" title="Back"><i class="fa fa-arrow-left"></i></a>
                </div>
            </div>
            <div class="col-xs-4 text-center">
                {% if post is defined %}
                    <h5>{{ post.getTitle }}</h5>
                {% else %}
                    <h5>New post</h5>
                {% endif %}
            </div>
            <div class="col-xs-4 text-right affix-right-controls">
            </div>
        </div>
    </div>

    <div class="xhr-container affix-collection">

    {{ form_start(form) }}
    <div class="tab-wrap form">
        <ul class="nav nav-tabs" role="tablist" id="posts-tabs">
            <li class="active"><a href="#home" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-align-justify"></span> Content</a></li>
            <li><a href="#media" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-picture"></span> Media</a></li>
            <li><a href="#settings" role="tab" data-toggle="tab"><span class="glyphicon glyphicon-cog"></span> Settings</a></li>
        </ul>

        <div class="tab-content post-content">
            <div class="tab-pane active new-post-pane" id="home">
                <div class="form-group title field">
                    {{ form_label(form.title) }}
                    {{ form_widget(form.title) }}
                    {{ form_errors(form.title) }}
                </div>
                <div class="form-group field">
                    {{ form_label(form.subtitle) }}
                    {{ form_widget(form.subtitle) }}
                    {{ form_errors(form.subtitle) }}
                </div>

                <div class="row ">
                    <div class="col-xs-6">
                        <div class="form-group field prepend-icon">
                            {{ form_label(form.tags) }}
                            {% if post is defined %}
                                {{ form_widget(form.tags, {'attr': {'value': post.getTagsString}}) }}
                            {% else %}
                                {{ form_widget(form.tags) }}
                            {% endif %}
                            <div class="field-addon"><i class="fa fa-tag"></i></div>
                        </div>
                    </div>

                    <div class="col-xs-6">
                        <div class="form-group field prepend-icon">
                            {{ form_label(form.keywords) }}
                            {{ form_widget(form.keywords) }}
                            <div class="field-addon"><i class="fa fa-tag"></i></div>
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    {{ form_label(form.body) }}
                    {{ form_widget(form.body | raw) }}
                    {{ form_errors(form.body) }}
                </div>
                <a href="#" class="btn-cmd cmd-edit-modal"></a>

                {# {{ form_row(form.body) }}#}
            </div>
            <div class="tab-pane" id="media">
                <h5>Media items</h5>
                <div class="row media collection">
                    <div class="clearfix col-lg-12">
                        <div class="tiles container-fluid">
                        {% for mediaItem in form.media %}
                            <div class="tb-col col-lg-2 col-md-3 col-sm-4 col-xs-6">
                                <div class="thumbnail media-selection">
                                    <div class="state">
                                        <div href="#"><i class="fa fa-check"></i></div>
                                    </div>
                                    <img width="50" src="{{ app.request.basepath ~ '/uploads/crops/' ~ mediaItem.vars.label }}.jpeg" />
                                    {% if post is defined %}
                                        {% for item in post.getMediaItems %}
                                            {% if mediaItem.vars.value == item.getId %}
                                                {{ form_widget(mediaItem, {'attr': {'checked': 'checked'}}) }}
                                            {% endif %}
                                        {% endfor %}
                                    {% endif %}
                                    {{ form_widget(mediaItem) }}
                                </div>
                            </div>
                        {% endfor %}
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-pane" id="settings">
                <div class="item-settings row">
                    <div class="panel panel-box col-xs-12">
                        <div class="panel-heading"><span class="glyphicon glyphicon-globe"></span> Publishing options</div>
                    </div>
                    <div class="panel panel-box col-xs-6">

                        <div class="panel-body">

                            <div class="field option">
                                {{ form_row(form.published) }}
                            </div>

                            <div class="form-group field prepend-icon">
                                {{ form_label(form.published_interval) }}
                                {{ form_widget(form.published_interval) }}
                                <div class="field-addon"><i class="fa fa-calendar"></i></div>
                                {{ form_errors(form.published_interval) }}
                            </div>
                        </div>
                    </div>

                    <div class="panel panel-box col-xs-6">
                        <div class="panel-body">
                            <div class="field option">
                                {{ form_row(form.exposed) }}
                            </div>

                            <div class="form-group">
                                <div class="form-group field prepend-icon">
                                    {{ form_label(form.exposed_interval) }}
                                    {{ form_widget(form.exposed_interval) }}
                                    <div class="field-addon"><i class="fa fa-calendar"></i></div>
                                    {{ form_errors(form.exposed_interval) }}
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="panel panel-box col-xs-12">
                        <div class="panel-heading"><span class="glyphicon glyphicon-comment"></span> Comments & ratings</div>
                    </div>
                    <div class="panel panel-box col-xs-12">
                        <div class="panel-body">
                            <div class="field option">
                                {{ form_row(form.allow_ratings) }}
                            </div>
                            <div class="field option">
                                {{ form_row(form.allow_comments) }}
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="form-group submit-controls post-submit-controls">
            {{ form_widget(form.save) }}
            {{ form_widget(form.cancel) }}
        </div>
    </div>
    {{ form_end(form) }}
    </div>
</div>

<div id="modal-editor" class="modal">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <span class="modal-title">Modal title</span>
            </div>
            <div class="modal-body">
                <p>One fine body&hellip;</p>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
{% endblock %}
